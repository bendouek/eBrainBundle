<project name="Untitled" app="Snap! 10.4.6, https://snap.berkeley.edu" version="2"><notes></notes><thumbnail>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAB4CAYAAAB1ovlvAAAAAXNSR0IArs4c6QAACMhJREFUeF7tnW1MlFcWx/8zgzgzzABqxRUiqS+oYEDarmBwNeuuNaS71myMWkzUyMZqWz/0QxPbrWa/EDfZTdekjalLomvsogkUyCorGmsIbHWrxpSANCjJGhXFl6UFVGCEmdnc24wtb8MMwpxn+vyfL5OZufeec//nl3PnOXMGLH6/3w9eVEBIAQsBFFKeZrUCBJAgiCowAMD79++LOhPM+IwZMwzrGx0buwJDAHz8+PHYVxtmZuLpP4S1ns+VhK5fvDtkzty5c8Nah4OjQ4EJBTCh7i+wN58KW4n7b9YQwLBVi84JQQHs7+9Henq63tn+/fuxZs0ajHbTvGTJEly+fFnPGQlA+7Yj8FR8AH9n27CqEcDohGksXgcFsKCgAMePH9frVlVVITExET6fDxaLBefOnUN1dTXsdju6u7ufQbdixQrU1dUFB7DgY3hO/YkAjiViP7E5QQEsLi7Gjh07cOnSJdy9exf19fXYunUrGhoasGzZMuTm5uLEiRPYuHEjGhsbtTQE8CdGyARvZ9TPgDdu3EBSUpLOenFxcXjw4IGGMSYmBhkZGejs7ITX68W0adO0q7du3UJqamrQDBiT9Rv0N/xrxK3xCJ7gqBto+VEBfB5fJ9+oQ+LZP4a9BAEMW7KonTAAwNu3b6Ovr8+Qm5kzZ44h/aJTz6fAAADv3buHJ0+ePN+Kg2Y7r1aGtZ7P7kbvvFVD5rAOGJaMUTN4Qo/g+C//Csc3J8MWg0dw2JJF7YSgAKqSy9q1azF9+nQUFhZi+fLlQeuAHR0d2LVrF44ePQqr1TpiHdC5+0v01f4NfV99NqxwBDBqeQrb8aAA7ty5EwcPHsTTp09x5swZpKWloaysDOvWrcO+ffvgdrtx9epVuFwuXRMsLy/X7x07dgybNm0aFsCY9F/D/6Qdjrcq8PiD4T/XEcCw4xi1E4ICWFRUhL1796KlpUWDpj4fqrLLrFmzdDmmsrISq1evRklJCS5evIimpib92p49e0Ysw9gW/BLofQTHzjICGLXYjJ/jo34GPHDgAKZMmYKcnBw4HA6cPn1ag6hqf9nZ2bh586Y+lrdt24ZDhw7p99TYpUuXDn8EW61wvnMST/9djP76f/IIHr9YRuVKowL4PLtyNlXCff7jsJfgERy2ZFE7YQCAra2t8Hg8htyMuhEazys+Pn48l+NaY1RgwuuAYfnl98L2aJybYi1WeN0/Y10xrEBEbvCEHsHhbmNG8coBU36/pB0t7v6Ql1kVuwpvOrbD+V0rXP/5FFbPIz2XR3rIEkZ8oGEBLMj9H6pSekIW5POEz5E9KfuH8X4fXijdCltnKwEMWcXIDwwKoLoDzs/PR0pKCjZv3qxrgIFL3QWr8suWLVv0S6oRtaurC9euXdPPVTOr6pj58TV4jnpPvaa+f1Z9hYEMGIAv15WLBfYFKGkv0ct4/V796LK50O3rhs/v08/TbGmonlI9RD1bbwdeOPo7Ahh5rkK2OCqAqqi8ePFiPHz4EO3t7Zg5cyYWLlyIvLw83LlzRzei1tTU6BJNAEBVM1R1QtVPqC7V5KBAHjxHFbJVwXr79u3PAHz75W/x2Yvffx/9yYufIM+Vh3n2eejwdmBDywbsTt6NDEcGnFYnUr/+vu3rDfsbKHIVDbtpBTWP4JB5iPjAUQFUd4u1tbVQX7NlZmZi/vz5qKio0Nnw8OHDug9Q3T0fOXJEA3jhwgWcP39eA7dy5UpkZWXpjumenh6UlpYOmKMyrGp2VZkykAH7rH7Me+0uvo314dWEV7F+6nokxiQiy5mF926+hw9TPkSntxNTbVOR05SjBXtp0ksoS/ghOwdUtPR7kHQ4nwBGHKvQDQYFUP1CTmUpVWhWGU01pqoj02az6cy3aNEiqA6a2bNno62tTY9T7ycnJ+P69eu6YbW5uRmqkyU2NlbD9uM5qslVjVNQqytwBAcg9DrceD/5fTR2N6K5txmF0wtxquMUXk98HeXfleNs59lnO62fVg+XxTVg5wk1+2BvOUsAQ+ch4iMNexOiIEzPb4N6DOWaZJmEj1wfIdueizhPH+Jr/4zYO1f0VB7BoSgoM8ZQAKpsFff1P8ZXCYsV7ev/PmRN9heOr8xjXW0AgOpGo7e3d6xrRdU81VDBS14B/m0Y+RiY2gMCaOrwy2+eAMrHwNQeEEBTh19+8wRQPgam9oAAmjr88psngPIxMLUHBNDU4ZffPAGUj4GpPSCApg6//OYJoHwMTO0BATR1+OU3TwDlY2BqDwigqcMvv3kCKB8DU3tAAE0dfvnNE0D5GJjaAwJo6vDLb94QAAb++9KD/jY09lxBQ88VtHi+kVcnij2YbLEjy/lzZDpeRqbjFUyGXf+rDaNdhgDwrVsbUNU59He9RhMr2v35NLUUv01Yb6htEEBDhWNinSGAI+jLDDix4AVWJ4AEMDKkjWCFABJAAjhIAX4GFEUissaZAZkBI0vcIGsEkAASQB7BogyIGmcGZAYkgMyAogyIGmcGZAYkgMyAogyIGmcGZAYkgMyAogyIGmcGZAYkgMyAogyIGmcGZAYkgMyAogyIGmcGZAYkgMyAogyIGmcGZAYkgEbMgAGf/uu5ji+6TuKLrip81V0rGqxoN+6yurEqfg1+5X5NP6rnRrwM0RFtRGHoU2QUIICR0ZlWRlCAABINUQUIoKj8NE4AyYCoAgRQVH4aJ4BkQFQBAigqP40TQDIgqgABFJWfxgkgGRBVgACKyk/jBJAMiCpAAEXlp3ECSAZEFSCAovLTOAEkA6IKEEBR+WmcAJIBUQUIoKj8NE4AyYCoAgRQVH4aJ4BkQFQBAigqP40TQDIgqgABFJWfxgkgGRBVgACKyk/jBJAMiCpAAEXlp3ECSAZEFSCAovLTOAEkA6IKEEBR+WmcAJIBUQUIoKj8NE4AyYCoAgRQVH4aJ4BkQFQBAigqP40TQDIgqgABFJWfxgkgGRBVgACKyk/jBJAMiCpAAEXlp3ECSAZEFSCAovLT+P8BOTxm5P3vNCcAAAAASUVORK5CYII=</thumbnail><scenes select="1"><scene name="Untitled"><notes></notes><palette><category name="Advanced eBrain" color="0,116,143,1"/></palette><hidden></hidden><headers></headers><code></code><blocks><block-definition s="connect to IP %&apos;ip&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><block s="reportJoinWords"><list><l>if (eb == undefined ) {eb = new EveBrain(&apos;ws://</l><block var="ip"/><l>:8899/websocket&apos;);&#xD;console.log(eb.connected);&#xD;} else {&#xD;if (eb.connected == false) {&#xD;eb.url= "ws://</l><block var="ip"/><l>:8899/websocket";  eb.connect();}}</l></list></block></block><list></list></block><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>ebUSB = undefined; // signal not connected by usb</l></block><list></list></block></script></block-definition><block-definition s="connect USB" type="command" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>eb = undefined; // signal that not connected by wifi&#xD;USBconnect().then(function() {&#xD;  world.moveon = 1;&#xD;}).catch(function(s) {&#xD;  morphicAlert("USB Connection Failed!", &#xD;  "Connection to robot by USB failed.", &#xD;  "Make sure to select a port when the window shows up.");&#xD;  world.moveon = -1;&#xD;});&#xD;&#xD;ebUSB = new EveBrainUSB();</l></block><list></list></block></script></block-definition><block-definition s="connected" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>&#xD;try {&#xD;  if ((eb != undefined ? eb.connected : false) || (ebUSB != undefined ? ebUSB.connected : false)){&#xD;    return true; &#xD;  } else {&#xD;    return false;&#xD;  }&#xD;} catch(e) {&#xD;  return false;&#xD;}</l></block><list></list></block></block></script></block-definition><block-definition s="test connection" type="command" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>try {&#xD;  if ((eb != undefined) || (ebUSB != undefined)){&#xD;    //it thinks its connected over websock, let&apos;s test the connection&#xD;   if (eb != undefined) {&#xD;     eb.connected = false;&#xD;     eb.version(function(status,msg){eb.connected = true;});&#xD;   } else {&#xD;     //it thinks we are connected over USB&#xD;     ebUSB.testConnection();&#xD;   } &#xD;  }&#xD;} catch(e) {&#xD;  console.log(e);&#xD;}</l></block><list></list></block></script></block-definition><block-definition s="Connect to eBrain %&apos;ip&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s">USB<options>USB&#xD;WIFI =192.168.4.1</options></input></inputs><script><block s="doIf"><block s="reportNot"><custom-block s="world modified"></custom-block></block><script><custom-block s="addJS %s"><custom-block s="eBrainJS"></custom-block></custom-block><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>world.modified = 1;</l></block><list></list></block></script><list></list></block><custom-block s="test connection"></custom-block><block s="doWait"><l>0.1</l></block><block s="doIf"><block s="reportNot"><custom-block s="connected"></custom-block></block><script><block s="doIfElse"><block s="reportVariadicEquals"><list><block var="ip"/><l>USB</l></list></block><script><block s="doIfElse"><custom-block s="can use webserial"></custom-block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>world.port = &apos;&apos;;&#xD;world.moveon = 0;</l></block><list></list></block><custom-block s="connect USB"></custom-block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block><block s="doIf"><block s="reportVariadicEquals"><list><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block><l>-1</l></list></block><script><block s="doStopThis"><l><option>this block</option></l></block></script><list></list></block></script><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>morphicAlert("ERROR!", "ERROR! This device on this browser cannot use a USB connection!",&#xD;"Special note: if you are on snap.robotinacan.com and you wish to connect using USB please change http to https in the titlebar");</l></block><list></list></block><block s="doStopThis"><l><option>this block</option></l></block></script></block></script><script><block s="doIfElse"><custom-block s="can use unsecure websocket"></custom-block><script><block s="doIfElse"><block var="ip"/><script><custom-block s="connect to IP %s"><block var="ip"/></custom-block></script><script><custom-block s="connect"></custom-block></script></block></script><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>morphicAlert("ERROR!", "ERROR! This device on this browser cannot use a WiFi connection!",&#xD;"Special note: if you are on snap.robotinacan.com and you wish to connect using WiFi please change https to http in the titlebar");</l></block><list></list></block><block s="doStopThis"><l><option>this block</option></l></block></script></block></script></block></script><list></list></block><custom-block s="test connection"></custom-block><block s="doWait"><l>0.3</l></block><block s="doIf"><block s="reportNot"><custom-block s="connected"></custom-block></block><script><custom-block s="test connection"></custom-block><block s="doWait"><l>0.3</l></block><block s="doIf"><block s="reportNot"><custom-block s="connected"></custom-block></block><script><block s="doIfElse"><block s="reportVariadicAnd"><list><custom-block s="can use unsecure websocket"></custom-block><block s="reportNot"><custom-block s="can use webserial"></custom-block></block></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>morphicAlert("Connection Failure!", &#xD;"Connection Failure!",&#xD;"Ensure you are connected to the eBrain over WiFi, this device cannot use the USB port.",&#xD;"Special note: if you are on snap.robotinacan.com and want to connect over USB, go to the https version.", "See Help for more details");</l></block><list></list></block></script><script><block s="doIfElse"><block s="reportVariadicAnd"><list><custom-block s="can use webserial"></custom-block><block s="reportNot"><custom-block s="can use unsecure websocket"></custom-block></block></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>morphicAlert("Connection Failure!", "Connection Failure! Please ensure you have connected to the right USB port.",&#xD;"Ensure you are connected to the eBrain over USB, this version of Snap can only connect over USB.",&#xD;"Special note: if you are on snap.robotinacan.com and you wish to connect using WiFi please change https to http in the titlebar.");</l></block><list></list></block></script><script><block s="doIfElse"><block s="reportVariadicAnd"><list><custom-block s="can use webserial"></custom-block><custom-block s="can use unsecure websocket"></custom-block></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>morphicAlert("Connection Failure!", "Connection failed!",&#xD;"In this mode you may connect via USB or over WiFi",&#xD;"Please type the IP address to use WiFi or type USB to use the USB port");</l></block><list></list></block></script><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>morphicAlert("Connection Failure!", "Connection Failure!",&#xD;"Snap was unable to detect any method of connecting to the eBrain. Try reloading or closing and opening snap.");</l></block><list></list></block></script></block></script></block></script></block></script><list></list><comment w="90" collapsed="false">Signal to user connection failure</comment></block></script><list></list></block></script></block-definition><block-definition s="eBrainJS" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><l>var eb,ebUSB,escapable=/[\x00-\x1f\ud800-\udfff\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufff0-\uffff]/g,attempts=0;function filterUnicode(t){return escapable.lastIndex=0,escapable.test(t)?t.replace(escapable,function(t){return""}):t}var ParentEveBrain=function(){this.digitalSensor=[],this.robot_state="idle",this.cbs={},this.msg_stack=[],this.analogSensor={level:null},this.distanceSensor={level:null},this.tempSensor={level:null},this.humidSensor={level:null},this.compassSensor={x:null,y:null,z:null},this.config=null,this.sensorState={}};ParentEveBrain.prototype={constructor:ParentEveBrain,send:function(t,e){(t=filterUnicode(t)).id=Math.random().toString(36).substring(2,12),e&amp;&amp;(this.cbs[t.id]=e),t.arg&amp;&amp;"[object Object]"!=t.arg.toString()&amp;&amp;(t.arg=t.arg.toString()),["stop","pause","resume","ping","version"].indexOf(t.cmd)&gt;=0?this.send_msg(t):(this.msg_stack.push(t),this.process_msg_queue())},process_msg_queue:function(){"idle"===this.robot_state&amp;&amp;this.msg_stack.length&gt;0&amp;&amp;(this.robot_state="receiving",this.send_msg(this.msg_stack[0]))},clearMessagesCallbacks:function(){this.cbs={},this.msg_stack=[]},stop:function(){var t=this;this.send({cmd:"stop"},function(e,s,n){if("complete"===e&amp;&amp;!n){for(var o in t.cbs)t.cbs[o]("complete",void 0,!0);t.robot_state="idle",t.clearMessagesCallbacks()}})},wifiScan:function(t){this.send({cmd:"startWifiScan"},null),this.cbs.wifiScan=function(e,s){t(e,s)}},connect_to_network:function(t,e,s){this.send({cmd:"setConfig",arg:{sta_ssid:t,sta_pass:e}},s)},postToServer:function(t,e,s,n,o,i){t="On"===t?1:0,this.send({cmd:"postToServer",arg:{onOff:t,server:e,time:s,toggleTempHumidity:n,toggleDistance:o}},i)},digitalInput:function(t,e){var s=this;this.send({cmd:"digitalInput",arg:t},function(n,o){e(n,o),"complete"===n&amp;&amp;null!=o&amp;&amp;(s.digitalSensor[t]=o.msg)})},digitalNotify:function(t,e){this.send({cmd:"digitalNotify",arg:t},e)},digitalStopNotify:function(t,e){var s="pin_"+t+"_status";delete this.sensorState[s],this.send({cmd:"digitalStopNotify",arg:t},e)},analogInput:function(t,e){var s=this;this.send({cmd:"analogInput",arg:t},function(t,n){"complete"===t&amp;&amp;null!=n&amp;&amp;(s.analogSensor.level=n.msg,e(t,n))})},gpio:function(t,e,s){this.send({cmd:e[0],arg:t},s)},gpio_pwm:function(t,e,s){this.send({cmd:t,arg:e},s)},distanceInput:function(t){var e=this;this.send({cmd:"distanceSensor"},function(s,n){t(s,n),"complete"===s&amp;&amp;null!=n&amp;&amp;(e.distanceSensor.level=n.msg)})},compass:function(t){var e=this;this.send({cmd:"compassSensor"},function(s,n){t(s,n),"complete"===s&amp;&amp;null!=n&amp;&amp;(e.compassSensor.x=n.X,e.compassSensor.y=n.Y,e.compassSensor.z=n.Z)})},temperature:function(t){var e=this;this.send({cmd:"temperature"},function(s,n){t(s,n),"complete"===s&amp;&amp;null!=n&amp;&amp;(e.tempSensor.level=n.msg)})},humidity:function(t){var e=this;this.send({cmd:"humidity"},function(s,n){t(s,n),"complete"===s&amp;&amp;null!=n&amp;&amp;(e.humidSensor.level=n.msg)})},beep:function(t,e,s){this.send({cmd:"beep",arg:[t,1e3*e]},s)},getConfig:function(t){var e=this;this.send({cmd:"getConfig"},function(s,n){"complete"===s&amp;&amp;null!=n&amp;&amp;(e.config=n.msg),t(s,n)})},setServo:function(t,e,s){1==t?this.send({cmd:"servo",arg:e},s):2==t&amp;&amp;this.send({cmd:"servoII",arg:e},s)},move:function(t,e,s){if("number"!=typeof e&amp;&amp;isNaN(e))throw new Error("The distance must be a number");if(+e&lt;0)throw new Error("For this command, distance must be positive.");this.send({cmd:t,arg:e},s)},turn:function(t,e,s){this.send({cmd:t,arg:e},s)},forward:function(t,e){this.move("forward",t,e)},back:function(t,e){this.move("back",t,e)},left:function(t,e){this.move("right",t,e)},right:function(t,e){this.move("left",t,e)},leftMotorForward:function(t,e){this.move("leftMotorF",t,e)},rightMotorForward:function(t,e){this.move("rightMotorF",t,e)},leftMotorBackward:function(t,e){this.move("leftMotorB",t,e)},rightMotorBackward:function(t,e){this.move("rightMotorB",t,e)},arc:function(t,e,s,n){this.send({cmd:"arc",arg:[t,e,s]},n)}};var EveBrain=function(t){ParentEveBrain.call(this),this.url=t,this.connect(),this.cbs={},this.listeners=[],this.wifiNetworks={}};for(parentMemberName in EveBrain.prototype={connected:!1,error:!1,timeoutTimer:void 0,connect:function(){if(!this.connected&amp;&amp;!this.error){var t=this;try{clearTimeout(t.timeoutTimer),clearTimeout(t.connTimeout),clearTimeout(t.reconnectTimer),t.ws.close(),t.robot_state="idle",t.msg_stack=[],t.cbs={}}catch(t){console.log(t)}this.has_connected=!1,this.ws=filterUnicode(new WebSocket(this.url)),this.ws.onmessage=function(e){t.handle_ws(e)},this.ws.onopen=function(){t.version(function(){t.setConnectedState(!0),attempts=0})},this.ws.onerror=function(e){t.handleError(e),attempts+=1},this.ws.onclose=function(e){t.handleError(e),attempts+=1},attempts&lt;10&amp;&amp;(this.connTimeout=window.setTimeout(function(){if(!t.connected)try{t.ws.close()}catch(t){console.log(t)}},1e3))}},refresh:function(){var t=this;t.ws.close(),clearTimeout(t.connTimeout),t.robot_state="idle",t.msg_stack=[],t.cbs={},this.has_connected=!1,this.ws=filterUnicode(new WebSocket(this.url)),this.ws.onmessage=function(e){t.handle_ws(e)},this.ws.onopen=function(){t.version(function(){t.setConnectedState(!0)})},this.ws.onerror=function(e){t.handleError(e)},this.ws.onclose=function(e){t.handleError(e)}},setConnectedState:function(t){var e=this;clearTimeout(e.connTimeout),e.connected=t,t&amp;&amp;(e.has_connected=!0),e.has_connected&amp;&amp;setTimeout(function(){e.broadcast(e.connected?"connected":"disconnected")},100),t?e.reconnectTimer&amp;&amp;(clearTimeout(e.reconnectTimer),e.reconnectTimer=void 0):!e.reconnectTimer&amp;&amp;attempts&lt;10?e.reconnectTimer=setTimeout(function(){e.reconnectTimer=void 0,e.connect()},1e3):attempts&gt;=10&amp;&amp;(morphicAlert("Robot Disconnected!","Robot disconnected by WiFi!\nPlease reconnect using the Connect block and unpause."),world.moveon=1,world.children[0].stage.threads.pauseAll())},broadcast:function(t){for(i in this.listeners)this.listeners.hasOwnProperty(i)&amp;&amp;this.listeners[i](t)},addListener:function(t){this.listeners.push(t)},handleError:function(t){t instanceof CloseEvent||"Timeout"===t?(this.ws.readyState===WebSocket.OPEN&amp;&amp;this.ws.close(),this.setConnectedState(!1),clearTimeout(self.reconnectTimer),self.reconnectTimer=void 0,this.msg_stack=[]):console.log(t)},analogInputPCF:function(t,e){var s=this;this.send({cmd:"readSensors",arg:t},function(t,n){"complete"===t&amp;&amp;null!=n&amp;&amp;(s.analogSensor.level=n.msg,e(s.analogSensor.level))})},ping:function(t){this.send({cmd:"ping"},t)},version:function(t){this.send({cmd:"version"},t)},send_msg:function(t){var e=this;t=filterUnicode(t),console.log(t),this.ws.readyState===WebSocket.OPEN&amp;&amp;this.ws.send(JSON.stringify(t)),this.timeoutTimer=window.setTimeout(function(){e.handleError("Timeout")},3e3)},handle_ws:function(t){if(void 0!==t){if(msg=JSON.parse(t.data),msg.msg=filterUnicode(msg.msg),msg.id=filterUnicode(msg.id),msg.status=filterUnicode(msg.status),console.log(msg),clearTimeout(this.timeoutTimer),"notify"===msg.status)return this.broadcast(msg.id),this.sensorState[msg.id]=msg.msg,void(this.cbs[msg.id]&amp;&amp;(this.cbs[msg.id]("notify",msg),delete this.cbs[msg.id]));this.msg_stack.length&gt;0&amp;&amp;this.msg_stack[0].id==msg.id?"accepted"===msg.status?(this.cbs[msg.id]&amp;&amp;this.cbs[msg.id]("started",msg),this.robot_state="running"):"complete"===msg.status&amp;&amp;(this.cbs[msg.id]&amp;&amp;(this.cbs[msg.id]("complete",msg),delete this.cbs[msg.id]),this.msg_stack.shift(),0===this.msg_stack.length&amp;&amp;this.broadcast("program_complete"),this.robot_state="idle",this.process_msg_queue()):this.cbs[msg.id]&amp;&amp;(this.cbs[msg.id]("complete",msg),delete this.cbs[msg.id]),"error"===msg.status&amp;&amp;morphicAlert("Error",msg.msg),msg.status&amp;&amp;"error"===msg.status&amp;&amp;"Too many connections"===msg.msg&amp;&amp;(this.error=!0,this.broadcast("error"))}else t.data=0,t.status=0,t.id=0},robot_state:"idle",msg_stack:[]},ParentEveBrain.prototype)EveBrain.prototype[parentMemberName]=ParentEveBrain.prototype[parentMemberName];var EveBrainUSB=function(){ParentEveBrain.call(this),this.cbs={},world.port?this.connected=!0:this.connected=!1};let inputDone,outputDone;async function USBconnect(){world.port=await navigator.serial.requestPort(),ebUSB&amp;&amp;(ebUSB.connected=!0),await world.port.open({baudRate:230400}),world.port.addEventListener("disconnect",t=&gt;{ebUSB&amp;&amp;(ebUSB.connected=!1),morphicAlert("Robot Disconnected!","Robot disconnected by USB!\nPlease reconnect using the Connect block and unpause."),world.moveon=1,world.children[0].stage.threads.pauseAll()});const t=new TextEncoderStream;outputDone=t.readable.pipeTo(world.port.writable),world.outputStream=t.writable;let e=new TextDecoderStream;inputDone=world.port.readable.pipeTo(e.writable),inputStream=e.readable,world.reader=inputStream.getReader(),readLoop()}async function readLoop(){for(world.USB="",console.log("USB Reader Listening...");;){const{value:n,done:o}=await world.reader.read();if(n&amp;&amp;(world.USB+=n,console.log(n+"\n"),world.USB.includes("}"))){for(var t=tryParseeBrainResponse(world.USB),e=0;e&lt;t.parsed.length;e++){var s=t.parsed[e];ebUSB&amp;&amp;ebUSB.doCallback(s)}world.USB="",t.unparseable&amp;&amp;(world.USB=t.unparseable)}if(o){console.log("[readLoop] DONE",o),world.reader.releaseLock();break}}}function tryParseeBrainResponse(t){for(var e={parsed:[]},s=t.split("\r\n"),n=0;n&lt;s.length;n++)try{var o=JSON.parse(s[n]);o&amp;&amp;"object"==typeof o&amp;&amp;o.id&amp;&amp;e.parsed.push(o)}catch(t){n==s.length-1&amp;&amp;(e.unparseable=s[n])}return e}function writeToStream(...t){const e=world.outputStream.getWriter();t.forEach(t=&gt;{console.log("[SEND]",t),e.write(t+"\n")}),e.releaseLock()}function morphicAlert(t,...e){if(Array.isArray(e)&amp;&amp;e.length&gt;0){for(var s="",n=0;n&lt;e.length-1;n++)s+=e[n]+"\n";morphicAlertString(t,s+=e[e.length-1])}else morphicAlertString(t,"string"==typeof e?e:null==e?"[Error message is missing. Please report that this happened to the developers.]":e.toString())}EveBrainUSB.prototype=Object.create(ParentEveBrain.prototype),Object.defineProperty(EveBrainUSB.prototype,"constructor",{value:EveBrainUSB,enumerable:!1,writable:!0}),EveBrainUSB.prototype.send_msg=function(t,e){t=filterUnicode(t),writeToStream(JSON.stringify(t))},EveBrainUSB.prototype.doCallback=function(t){if(t&amp;&amp;"accepted"==t.status)this.robot_state="running",this.cbs[t.id]&amp;&amp;this.cbs[t.id]("started",t);else if(t&amp;&amp;"complete"==t.status)this.cbs[t.id]&amp;&amp;(this.cbs[t.id]("complete",t),delete this.cbs[t.id]),this.robot_state="idle",this.msg_stack.shift(),this.process_msg_queue();else{if(t&amp;&amp;"notify"===t.status)return this.sensorState[t.id]=t.msg,void(this.cbs[t.id]&amp;&amp;(this.cbs[t.id]("notify",t),delete this.cbs[t.id]));t&amp;&amp;"error"===t.status&amp;&amp;morphicAlert("Error",t.msg)}},EveBrainUSB.prototype.testConnection=function(){this.connected=!1;var t=this;this.send({cmd:"version"},function(e,s){"complete"===e&amp;&amp;(t.connected=!0)})},world.outputStream=void 0;var activeAlerts=new Map;function morphicAlertString(t,e){var s=t+e;if(void 0!==activeAlerts.get(s))return;let n=new DialogBoxMorph;n.labelString=t,n.createLabel();!function(t,e){let s=new TextMorph(t);s.isBold=!1,n["add"+e](s)}(e,"Body"),n.titleBarColor=new Color(255,0,0,1),n.titlePadding=12,activeAlerts.set(s,n),n.cancelAndProcess=function(){n.ok(),activeAlerts.delete(s)},n.addButton("cancelAndProcess","Close"),n.fixLayout(),n.popUp(world)}</l></block></script></block-definition><block-definition s="addJS %&apos;JS_FILE&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>JS_FILE</l></list><l>var po = document.createElement(&apos;script&apos;);&#xD;  po.type = &apos;text/javascript&apos;;&#xD;  po.async = true;&#xD;  po.innerHTML = JS_FILE;&#xD;  var s = document.getElementsByTagName(&apos;script&apos;)[0];&#xD;  s.parentNode.insertBefore(po, s)</l></block><list><block var="JS_FILE"/></list></block></script></block-definition><block-definition s="world modified" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.modified == 1 || world.modified != undefined;</l></block><list></list></block></block></script></block-definition><block-definition s="Forward %&apos;mm&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s">100</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.forward(mm,function(state, msg){&#xD;  if(state == &apos;complete&apos;){&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="mm"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="Back %&apos;mm&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s">100</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.back(mm,function(state,msg){&#xD;  if(state == &apos;complete&apos;){&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="mm"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="Left %&apos;mm&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s">90</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.left(mm,function(state,msg){&#xD;  if(state == &apos;complete&apos;){&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="mm"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="Right %&apos;mm&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s">90</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.right(mm,function(state,msg){&#xD;  if(state == &apos;complete&apos;){&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="mm"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="connect" type="command" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>ebUSB = undefined; // signal not connected by usb&#xD;if (eb == undefined) {&#xD;  eb = new EveBrain(&apos;ws://192.168.4.1:8899/websocket&apos;);&#xD;  console.log(eb.connected);&#xD;} else {&#xD;  if (eb.connected == false) {&#xD;    eb.url = "ws://192.168.4.1:8899/websocket";&#xD;    eb.connect();&#xD;  }&#xD;}</l></block><list></list></block></script></block-definition><block-definition s="connection type" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>try {&#xD;  if(eb != undefined ? eb.connected : false){&#xD;    return &apos;WEB&apos;; &#xD;  }  &#xD; else if(ebUSB != undefined ? ebUSB.connected: false){&#xD;    return &apos;USB&apos;; &#xD;  }&#xD; else {&#xD;   return &apos;NONE&apos;; &#xD;  }&#xD;} catch(e) {&#xD;  return "NONE";&#xD;}</l></block><list></list></block></block></script></block-definition><block-definition s="Stop" type="command" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>eb.stop();</l></block><list><custom-block s="connection object"></custom-block></list></block></script></block-definition><block-definition s="GPIO Write Pin: %&apos;Pin&apos; %&apos;ON/OFF&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">4<options>4&#xD;5&#xD;10&#xD;16&#xD;14&#xD;12&#xD;13&#xD;0&#xD;2</options></input><input type="%s" readonly="true">gpio_on<options>gpio_on&#xD;gpio_off</options></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>Pin</l><l>State</l><l>eb</l></list><l>world.moveon = 0;&#xD;try{&#xD;  eb.gpio(Pin,[State],function(state, msg){&#xD;    if (state == &apos;complete&apos;) {&#xD;      world.moveon = 1;&#xD;    }&#xD;  });&#xD;}&#xD;catch(e){&#xD;}</l></block><list><block var="Pin"/><block var="ON/OFF"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="GPIO Read Pin %&apos;Pin&apos;" type="reporter" category="other"><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">4<options>4&#xD;5&#xD;10&#xD;16&#xD;14&#xD;12&#xD;13&#xD;0&#xD;2</options></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>Pin</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.digitalInput(Pin,function(state, msg){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="Pin"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>Pin</l><l>eb</l></list><l>return eb.digitalSensor[Pin];</l></block><list><block var="Pin"/><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="Analog Read" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.analogInput(0,function(state, msg){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return eb.analogSensor.level;</l></block><list><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="Read Distance" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.distanceInput(function(state, msg) { &#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return  eb.distanceSensor.level;</l></block><list><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="Temperature Read" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.temperature(function(state, msg){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return eb.tempSensor.level;</l></block><list><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="Humidity Read" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.humidity(function(state, msg){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return eb.humidSensor.level;</l></block><list><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="PWM Pin: %&apos;Pin&apos; Value (0-255): %&apos;pin_value&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">5<options>5&#xD;10&#xD;16</options></input><input type="%n">255</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>pin</l><l>pin_value</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.gpio_pwm("gpio_pwm_" + pin, pin_value, function(state, msg){&#xD;  if (state == &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="Pin"/><block var="pin_value"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="Beep Pin 5 Duration: %&apos;duration&apos; Note: %&apos;note&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%n">1</input><input type="%n">60</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>duration</l><l>note</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.beep(note,duration,function(state, msg){&#xD;  if (state == &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="duration"/><block var="note"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="Connect to Network SSID: %&apos;SSID&apos; Password: %&apos;PASS&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>SSID</l><l>PASS</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.connect_to_network(SSID, PASS, function(state, msg){&#xD;  if (state == &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="SSID"/><block var="PASS"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="Get WiFi Networks" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.wifiScan(function(){&#xD;  world.moveon = 1;&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>&#xD;var networks = eb.sensorState["wifiScan"];&#xD;let txt = "";&#xD;for (let i = 0; i &lt; networks.length; i++){&#xD;&#xD;txt = txt.concat(networks[i][0]);&#xD;if(i != networks.length){  &#xD;  txt = txt.concat(",");}&#xD;}&#xD;return(networks);</l></block><list><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="Set Servo %&apos;one&apos; Angle %&apos;angle&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">1<options>1&#xD;2</options></input><input type="%n">90</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>angle</l><l>one</l><l>eb</l></list><l>world.moveon = 0;&#xD;eb.setServo(one, angle, function(state, msg){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="angle"/><block var="one"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block-definition><block-definition s="Get IP" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.getConfig(function(state, msg){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return eb.config.sta_ip;</l></block><list><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="Get Config" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.getConfig(function(state, message){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return  JSON.stringify(eb.config);</l></block><list><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="Get Robot Name" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.getConfig(function(state, msg){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return  eb.config.ap_ssid;</l></block><list><custom-block s="connection object"></custom-block></list></block></block></script></block-definition><block-definition s="%&apos;motor&apos; Motor %&apos;direction&apos; %&apos;mm&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">Left<options>Left&#xD;Right</options></input><input type="%s" readonly="true">Forward<options>Forward&#xD;Back</options></input><input type="%n">100</input></inputs><script><block s="doIfElse"><block s="reportNot"><block s="reportListContainsItem"><block s="reportNewList"><list><l>Left</l><l>Right</l></list></block><block var="motor"/></block></block><script><block s="doRun"><block s="reportJSFunction"><list></list><l>alert(&apos;Must use with "Left" or "Right" motor &apos;);</l></block><list></list></block></script><script><block s="doIfElse"><block s="reportNot"><block s="reportListContainsItem"><block s="reportNewList"><list><l>Forward</l><l>Back</l></list></block><block var="direction"/></block></block><script><block s="doRun"><block s="reportJSFunction"><list></list><l>alert(&apos;Must use going "Forward" or "Backward"&apos;);</l></block><list></list></block></script><script><block s="doRun"><block s="reportJSFunction"><list><l>motor</l><l>direction</l><l>mm</l><l>eb</l></list><l>world.moveon = 0;&#xD;var actionStr = motor.toLowerCase() + &apos;Motor&apos; + (direction === &apos;Forward&apos; ? &apos;F&apos; : &apos;B&apos;);&#xD;eb.move(actionStr, mm, function(state, msg) {&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><block var="motor"/><block var="direction"/><block var="mm"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script></block></script></block></script></block-definition><block-definition s="Close Connection" type="command" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doIf"><block s="reportVariadicEquals"><list><custom-block s="connection type"></custom-block><l>WEB</l></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>eb.ws.close();</l></block><list></list></block></script><list></list></block><block s="doIf"><block s="reportVariadicEquals"><list><custom-block s="connection type"></custom-block><l>USB</l></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>world.port.close()</l></block><list></list></block></script><list></list></block></script></block-definition><block-definition s="Move Left Motor %&apos;LeftMM&apos; mm and Right Motor %&apos;RightMM&apos; mm" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s">100</input><input type="%s">200</input></inputs><script><block s="doIfElse"><block s="reportVariadicEquals"><list><block var="LeftMM"/><block var="RightMM"/></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l><l>eb</l></list><l>world.moveon = 0;&#xD;var callback = function(state, msg) {&#xD;    if (state === &apos;complete&apos;) {&#xD;        world.moveon = 1;&#xD;    }&#xD;};&#xD;if (mm &gt; 0) {&#xD;    eb.forward(mm, callback);&#xD;} else {&#xD;    eb.back(-mm, callback);&#xD;}</l></block><list><block var="LeftMM"/><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script><script><block s="doRun"><block s="reportJSFunction"><list><l>LeftMM</l><l>RightMM</l><l>eb</l></list><l>// Calculate the ratio between mm and degrees&#xD;var steps_per_mm = 2038.0 / 254.4;&#xD;var steps_per_degree = ((108.5 * 3.1416) / 360) * steps_per_mm;&#xD;var degrees_per_mm = steps_per_degree / steps_per_mm;&#xD;&#xD;// Find the absolute values of the distances&#xD;var absLeftMM = Math.abs(LeftMM);&#xD;var absRightMM = Math.abs(RightMM);&#xD;&#xD;world.moveon = 0;&#xD;var callback = function(state, msg) {&#xD;    if (state === &apos;complete&apos;) {&#xD;        world.moveon = 1;&#xD;    }&#xD;};&#xD;&#xD;// start of with moving both motors&#xD;var minDistance = Math.min(absLeftMM, absRightMM);&#xD;if (LeftMM &gt;= 0 &amp;&amp; RightMM &gt;= 0) {&#xD;    eb.forward(minDistance, callback);&#xD;} else if (LeftMM &lt;= 0 &amp;&amp; RightMM &lt;= 0) {&#xD;    eb.back(minDistance, callback);&#xD;} else if (LeftMM &gt; 0) {&#xD;    eb.right(minDistance * degrees_per_mm, callback);&#xD;} else {&#xD;    eb.left(minDistance * degrees_per_mm, callback);&#xD;}</l></block><list><block var="LeftMM"/><block var="RightMM"/><custom-block s="connection object"></custom-block></list><comment w="140.83333333333334" collapsed="false">Here, run the command to run the motors as long as the smaller distance (ie if we are moving the Left one 50mm and the Right one 80mm, move both 50mm first).</comment></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block><block s="doRun"><block s="reportJSFunction"><list><l>LeftMM</l><l>RightMM</l><l>eb</l></list><l>// Calculate the ratio between mm and degrees&#xD;var steps_per_mm = 2038.0 / 254.4;&#xD;var steps_per_degree = ((108.5 * 3.1416) / 360) * steps_per_mm;&#xD;var degrees_per_mm = steps_per_degree / steps_per_mm;&#xD;// Find the absolute values of the distances&#xD;var absLeftMM = Math.abs(LeftMM);&#xD;var absRightMM = Math.abs(RightMM);&#xD;&#xD;world.moveon = 0;&#xD;var callback = function(state, msg) {&#xD;    if (state === &apos;complete&apos;) {&#xD;        world.moveon = 1;&#xD;    }&#xD;};&#xD;&#xD;var minDistance = Math.min(absLeftMM, absRightMM);&#xD;&#xD;&#xD;//End with moving the remaining motor the remaining distance&#xD;if (absLeftMM &gt; absRightMM) {&#xD;    var remainingDistance = absLeftMM - minDistance;&#xD;    if (LeftMM &lt; 0) {&#xD;        eb.rightMotorBackward(remainingDistance, callback);&#xD;    } else {&#xD;        eb.rightMotorForward(remainingDistance, callback);&#xD;    }&#xD;} else {&#xD;    var remainingDistance = absRightMM - minDistance;&#xD;    if (RightMM &lt; 0) {&#xD;        eb.leftMotorForward(remainingDistance, callback);&#xD;    } else {&#xD;        eb.leftMotorBackward(remainingDistance, callback);&#xD;    }&#xD;}&#xD;&#xD;</l></block><list><block var="LeftMM"/><block var="RightMM"/><custom-block s="connection object"></custom-block></list><comment w="90" collapsed="false">Here, run the motor with the longer distance to move (ie if we are moving the Left one 50mm and the Right one 80mm, now we are moving the Right one 30mm).</comment></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block></script><comment w="90" collapsed="false">If both distances are the same, run a forward/backwards command</comment></block></script></block-definition><block-definition s="connection object" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doIfElse"><block s="reportVariadicEquals"><list><custom-block s="connection type"></custom-block><l>WEB</l></list></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return eb;</l></block><list></list></block></block></script><script><block s="doIfElse"><block s="reportVariadicEquals"><list><custom-block s="connection type"></custom-block><l>USB</l></list></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return ebUSB;</l></block><list></list></block></block></script><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>// Since this block might be called before Connect, and Connect loads in morphicAlert,&#xD;// this falls back to a js alert.&#xD;try {&#xD;  morphicAlert("Connection Error!", "You are not connected to your eBrain!");&#xD;} catch (e) {&#xD;  alert("You are not connected to your eBrain!");&#xD;}</l></block><list></list></block><block s="doStopThis"><l><option>all</option></l></block></script></block></script></block></script></block-definition><block-definition s="delete var %&apos;names&apos;" type="command" category="variables"><comment x="0" y="0" w="217" collapsed="false">This block deletes all the variables with the names given (inside input list).&#xD;&#xD;Each name will make only one variable deletion, and this will be the variable found following the scope order: &apos;script&apos; -&gt; &apos;sprite&apos; -&gt; &apos;global&apos;.&#xD;&#xD;If we have a &quot;testing&quot; sprite variable and also a &quot;testing&quot; global one, deleting &quot;testing&quot; will delete only the sprite one (Yes! we can also do &quot;delete var (testing, testing)&quot; to delete both.&#xD;&#xD;If one variable does not exists (in any scope) an error happens, stopping block action in that point. You can check it before with the &quot;does var (name) exists?&quot;block. </comment><header></header><code></code><translations>pt:remove as variveis _&#xD;ca:esborra les variables _&#xD;es:borrar variables _&#xD;de:lschen var _&#xD;</translations><inputs><input type="%mult%txt"></input></inputs><script><block s="doForEach"><l>each item</l><block var="names"/><script><block s="doRun"><block s="reportJSFunction"><list><l>varName</l><l>proc</l></list><l>if ((typeof varName) != "string" || varName === "") {&#xD;    throw new Error("name isn&apos;t a string: " + varName);&#xD;}&#xD;if (typeof proc.homeContext.variables.vars[varName] !== &apos;undefined&apos;) {&#xD;    delete proc.homeContext.variables.vars[varName];&#xD;} else if (this.deletableVariableNames().indexOf(varName) != -1) {&#xD;    this.deleteVariable(varName);&#xD;} else {&#xD;    throw new Error("variable doesn&apos;t exist: " + varName);&#xD;}</l></block><list><block var="each item"/></list></block></script></block><block s="doRun"><block s="reportJSFunction"><list></list><l>var ide = this.parentThatIsA(IDE_Morph);&#xD;ide.flushBlocksCache(&apos;variables&apos;); // b/c of inheritance&#xD;ide.refreshPalette();</l></block><list></list></block></script></block-definition><block-definition s="set var %&apos;name&apos; to %&apos;value&apos;" type="command" category="variables"><comment x="0" y="0" w="240.4931640625" collapsed="false">This block sets the given value (last input) to the variable named with the name givent (var input).&#xD;&#xD;It looks for that variable following the scope order &apos;script&apos; -&gt; &apos;sprite&apos; -&gt; &apos;global&apos; (the first match it finds).&#xD;&#xD;If that variable does not exist (in any scope) an error happens, stopping their script. You can check it before using the &quot;does var (name) exists?&quot; block. </comment><header></header><code></code><translations>ca:assigna a _ el valor _&#xD;es:asignar a _ el valor _&#xD;pt:altera _ para _&#xD;de:setze var _ auf _&#xD;</translations><inputs><input type="%s"><options>_getVarNamesDict</options></input><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>varName</l><l>value</l><l>proc</l></list><l>if ((typeof varName) != "string") {&#xD;    throw new Error("name isn&apos;t a string: " + varName);&#xD;}&#xD;proc.homeContext.variables.setVar(varName, value);</l></block><list><block var="name"/><block var="value"/></list></block></script></block-definition><block-definition s="listify %&apos;jsonString&apos;" type="reporter" category="operators"><header></header><code></code><translations>pt:os dados JSON _ em formato de lista&#xD;</translations><inputs><input type="%mlt"></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>jsonString</l></list><l>return listify(JSON.parse(jsonString));&#xD;&#xD;function listify(jsonObject) {&#xD;  if (jsonObject instanceof Array) {&#xD;    return new List(jsonObject.map(function(eachElement) { return listify(eachElement)}));&#xD;  } else if (jsonObject instanceof Object) {&#xD;    return new List(Object.keys(jsonObject).map(function(eachKey) { return new List([eachKey,listify(jsonObject[eachKey])])} ))&#xD;  } else {&#xD;    return jsonObject&#xD;  }&#xD;}</l></block><list><block var="jsonString"/></list></block></block></script></block-definition><block-definition s="value at key %&apos;key&apos; of %&apos;lst&apos;" type="reporter" category="operators"><header></header><code></code><translations>pt:o valor com chave _ em _&#xD;</translations><inputs><input type="%s"></input><input type="%l"></input></inputs><script><block s="doWarp"><script><block s="doForEach"><l>each item</l><block var="lst"/><script><block s="doIf"><block s="reportVariadicEquals"><list><block s="reportListItem"><l>1</l><block var="each item"/></block><block var="key"/></list></block><script><block s="doReport"><block s="reportListItem"><l>2</l><block var="each item"/></block></block></script><list></list></block></script></block></script></block><block s="doReport"><l></l></block></script></block-definition><block-definition s="key: %&apos;key&apos; value: %&apos;value&apos;" type="reporter" category="operators"><header></header><code></code><translations>pt:um par (chave: _ , valor: _ )&#xD;</translations><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doReport"><block s="reportNewList"><list><block var="key"/><block var="value"/></list></block></block></script></block-definition><block-definition s="var %&apos;name&apos;" type="reporter" category="variables"><comment x="0" y="0" w="178.00000000000003" collapsed="false">This block reports the value of the variable with the name given.&#xD;&#xD;It looks for that variable following the scope order &apos;script&apos; -&gt; &apos;sprite&apos; -&gt; &apos;global&apos; (the first match it finds).&#xD;&#xD;If that variable does not exist (in any scope) an error happens, stopping their script. You can check it before using the &quot;does var (name) exists?&quot; block. </comment><header></header><code></code><translations>pt:o valor de _&#xD;</translations><inputs><input type="%s"><options>_getVarNamesDict</options></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>varName</l><l>proc</l></list><l>if ((typeof varName) != "string") {&#xD;    throw new Error("name isn&apos;t a string: " + varName);&#xD;}&#xD;return proc.homeContext.variables.getVar(varName);</l></block><list><block var="name"/></list></block></block></script></block-definition><block-definition s="does var %&apos;name&apos; exist?" type="predicate" category="variables"><comment x="0" y="0" w="146" collapsed="false">This block reports &quot;true&quot; if there is a variable with this given name (input slot) in that context.&#xD;&#xD;It can be a global, sprite or script variable.&#xD;&#xD;Otherwise it reports &quot;false&quot;.</comment><header></header><code></code><translations>pt:a varivel _ existe&#xD;ca:existeix la variable _ ?&#xD;es:existe la variable _ ?&#xD;de:existiert var _ ?&#xD;</translations><inputs><input type="%s"></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>varName</l><l>proc</l></list><l>if ((typeof varName) != "string" || varName === "") {&#xD;    throw new Error("name isn&apos;t a string: " + varName);&#xD;}&#xD;return proc.homeContext.variables.silentFind(varName)? true:false;</l></block><list><block var="name"/></list></block></block></script></block-definition><block-definition s="show var %&apos;name&apos;" type="command" category="variables"><comment x="0" y="0" w="181" collapsed="false">This block turns on (show) the watcher view on stage (if it was not already activated) of the variable with the given name (slot input).&#xD;&#xD;It can only access to the closest variable scope (if there different variables with the same name in different scopes) following the order &apos;script&apos; -&gt; &apos;sprite&apos; -&gt; &apos;global&apos;.&#xD;&#xD;No errors if that variable does not exist.</comment><header></header><code></code><translations>ca:mostra la variable _&#xD;es:mostrar variable _&#xD;pt:mostra a varivel _&#xD;de:zeige var _&#xD;</translations><inputs><input type="%s"><options>_getVarNamesDict</options></input></inputs><script><block s="doIf"><custom-block s="does var %s exist?"><block var="name"/></custom-block><script><block s="doRun"><block s="reportJSFunction"><list><l>varName</l><l>proc</l></list><l>    var varFrame = proc.homeContext.variables,&#xD;        stage,&#xD;        watcher,&#xD;        target,&#xD;        label,&#xD;        others,&#xD;        isGlobal,&#xD;        name = varName;&#xD;&#xD;    if (name instanceof Context) {&#xD;        if (name.expression.selector === &apos;reportGetVar&apos;) {&#xD;            name = name.expression.blockSpec;&#xD;        } else {&#xD;            proc.doChangePrimitiveVisibility(name.expression, false);&#xD;            return;&#xD;        }&#xD;    }&#xD;    if (proc.homeContext.receiver) {&#xD;        stage = proc.homeContext.receiver.parentThatIsA(StageMorph);&#xD;        if (stage) {&#xD;            target = varFrame.silentFind(name);&#xD;            if (!target) {return; }&#xD;            // first try to find an existing (hidden) watcher&#xD;            watcher = detect(&#xD;                stage.children,&#xD;                morph =&gt; morph instanceof WatcherMorph &amp;&amp;&#xD;                    morph.target === target &amp;&amp;&#xD;                        morph.getter === name&#xD;            );&#xD;            if (watcher !== null) {&#xD;                watcher.show();&#xD;                watcher.fixLayout(); // re-hide hidden parts&#xD;                return;&#xD;            }&#xD;            // if no watcher exists, create a new one&#xD;            isGlobal = contains(&#xD;                proc.homeContext.receiver.globalVariables().names(),&#xD;                varName&#xD;            );&#xD;            if (isGlobal || target.owner) {&#xD;                label = name;&#xD;            } else {&#xD;                label = name + &apos; &apos; + localize(&apos;(temporary)&apos;);&#xD;            }&#xD;            watcher = new WatcherMorph(&#xD;                label,&#xD;                SpriteMorph.prototype.blockColor.variables,&#xD;                target,&#xD;                name&#xD;            );&#xD;            watcher.setPosition(stage.position().add(10));&#xD;            others = stage.watchers(watcher.left());&#xD;            if (others.length &gt; 0) {&#xD;                watcher.setTop(others[others.length - 1].bottom());&#xD;            }&#xD;            stage.add(watcher);&#xD;            watcher.fixLayout();&#xD;        }&#xD;    }</l></block><list><block var="name"/></list></block></script><list></list></block></script></block-definition><block-definition s="hide var %&apos;name&apos;" type="command" category="variables"><comment x="0" y="0" w="181" collapsed="false">This block turns off (hide) the watcher view on stage (if it was not already activated) of the variable with the given name (slot input).&#xD;&#xD;It can only access to the closest variable scope (if there different variables with the same name in different scopes) following the order &apos;script&apos; -&gt; &apos;sprite&apos; -&gt; &apos;global&apos;.&#xD;&#xD;No errors if that variable does not exist.</comment><header></header><code></code><translations>ca:amaga la variable _&#xD;es:esconder variable _&#xD;pt:esconde a varivel _&#xD;de:verstecke var _&#xD;</translations><inputs><input type="%s"><options>_getVarNamesDict</options></input></inputs><script><block s="doIf"><custom-block s="does var %s exist?"><block var="name"/></custom-block><script><block s="doRun"><block s="reportJSFunction"><list><l>varName</l><l>proc</l></list><l>    // to delete all temporary watchers, use the primitive "hide" with no inputs&#xD;    var varFrame = proc.homeContext.variables,&#xD;        stage,&#xD;        watcher,&#xD;        target,&#xD;        name = varName;&#xD;&#xD;    if (name instanceof Context) {&#xD;        if (name.expression.selector === &apos;reportGetVar&apos;) {&#xD;            name = name.expression.blockSpec;&#xD;        } else {&#xD;            proc.doChangePrimitiveVisibility(name.expression, true);&#xD;            return;&#xD;        }&#xD;    }&#xD;    if (!name) {&#xD;        proc.doRemoveTemporaries();&#xD;        return;&#xD;    }&#xD;    if (proc.homeContext.receiver) {&#xD;        stage = proc.homeContext.receiver.parentThatIsA(StageMorph);&#xD;        if (stage) {&#xD;            target = varFrame.find(name);&#xD;            watcher = detect(&#xD;                stage.children,&#xD;                morph =&gt; morph instanceof WatcherMorph &amp;&amp;&#xD;                    morph.target === target &amp;&amp;&#xD;                        morph.getter === name&#xD;            );&#xD;            if (watcher !== null) {&#xD;                if (watcher.isTemporary()) {&#xD;                    watcher.destroy();&#xD;                } else {&#xD;                    watcher.hide();&#xD;                }&#xD;            }&#xD;        }&#xD;    }&#xD;</l></block><list><block var="name"/></list></block></script><list></list></block></script></block-definition><block-definition s="create %&apos;scope&apos; var %&apos;names&apos;" type="command" category="variables"><comment x="0" y="0" w="146" collapsed="false">This block creates  new variables on the selected scope: global (for all sprites), sprite (for this sprite only) or script (only for that blocks stack) with the names given (in &apos;names&apos; list).&#xD;&#xD;If there is already a variable with that name in that scope, it does nothing: no errors and no overwrites.</comment><header></header><code></code><translations>pt:cria as variveis _ _&#xD;ca:crea les _ variables _&#xD;es:crear las _ variables _&#xD;de:erstellen _ var _&#xD;</translations><inputs><input type="%s" readonly="true">global<options>global&#xD;sprite&#xD;script</options></input><input type="%mult%txt"></input></inputs><script><block s="doIfElse"><block s="reportVariadicEquals"><list><block var="scope"/><l>script</l></list></block><script><block s="doForEach"><l>each item</l><block var="names"/><script><block s="doRun"><block s="reportJSFunction"><list><l>varName</l><l>proc</l></list><l>if ((typeof varName) != "string" || varName === "") {&#xD;    throw new Error("name isn&apos;t a string: " + varName);&#xD;}&#xD;if (!proc.homeContext.variables.vars[varName]) proc.homeContext.variables.addVar(varName);</l></block><list><block var="each item"/></list></block></script></block></script><script><block s="doDeclareVariables"><list><l>global</l></list></block><block s="doIfElse"><block s="reportVariadicEquals"><list><block var="scope"/><l>sprite</l></list></block><script><block s="doSetVar"><l>global</l><block s="reportBoolean"><l><bool>false</bool></l></block></block></script><script><block s="doSetVar"><l>global</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script></block><block s="doForEach"><l>each item</l><block var="names"/><script><block s="doRun"><block s="reportJSFunction"><list><l>varName</l><l>global</l><l>proc</l></list><l>if ((typeof varName) != "string" || varName === "") {&#xD;    throw new Error("name isn&apos;t a string: " + varName);&#xD;}&#xD;if (global &amp;&amp; !proc.homeContext.variables.parentFrame.parentFrame.vars[varName]) this.addVariable(varName, true);&#xD;if (!global &amp;&amp; !proc.homeContext.variables.parentFrame.vars[varName]) this.addVariable(varName, false);</l></block><list><block var="each item"/><block var="global"/></list></block></script></block><block s="doRun"><block s="reportJSFunction"><list></list><l>var ide = this.parentThatIsA(IDE_Morph);&#xD;ide.flushBlocksCache(&apos;variables&apos;); // b/c of inheritance&#xD;ide.refreshPalette();</l></block><list></list></block></script></block></script></block-definition><block-definition s="fetch %&apos;url&apos; %&apos;data&apos;" type="reporter" category="sensing"><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s"></input></inputs><script><custom-block s="create %s var %mult%txt"><l>sprite</l><list><l>response</l></list></custom-block><block s="doRun"><block s="reportJSFunction"><list><l>url</l><l>proc</l></list><l>//Fetches data as a promise , on compleation saves to varable as text.&#xD;//if ((typeof varName) != "string") {&#xD;if ((typeof "response") != "string") {&#xD;    throw new Error("name isn&apos;t a string: " + varName);&#xD;}&#xD;&#xD;fetch(url)&#xD;  .then(response =&gt; response.json())&#xD;  .then(data =&gt; proc.homeContext.variables.setVar("response", JSON.stringify(data)));&#xD;&#xD;console.log(proc.homeContext.variables.allNames())</l></block><list><block var="url"/></list></block><block s="doWait"><l>0.2</l></block><block s="doReport"><block var="response"/></block></script></block-definition><block-definition s="%&apos;method&apos; url: %&apos;url&apos; send: %&apos;payload&apos; headers: %&apos;headers&apos;" type="reporter" category="sensing"><header></header><code></code><translations>pt:a resposta a _ de _ enviando _ e cabealhos _&#xD;</translations><inputs><input type="%s" readonly="true">GET<options>GET&#xD;POST&#xD;PUT&#xD;DELETE</options></input><input type="%s">https://snap.berkeley.edu</input><input type="%s"></input><input type="%mult%l" readonly="true"></input></inputs><script><custom-block s="create %s var %mult%txt"><l>sprite</l><list><l>response</l></list></custom-block><block s="doRun"><block s="reportJSFunction"><list><l>chosen_method</l><l>url</l><l>payload</l><l>headers</l><l>proc</l></list><l>console.log(chosen_method)&#xD;&#xD;payload = JSON.parse(payload)&#xD;&#xD;if (chosen_method == "GET") {&#xD;    fetch(url, {&#xD;            method: chosen_method&#xD;        })&#xD;        .then(response =&gt; response.json())&#xD;        .then(data =&gt; proc.homeContext.variables.setVar("response", JSON.stringify(data)))&#xD;} else if (chosen_method == "POST") {&#xD;    fetch(url, {&#xD;            method: chosen_method,&#xD;            headers: {&#xD;                &apos;Content-Type&apos;: &apos;application/json&apos;,&#xD;            },&#xD;            body: JSON.stringify(payload)&#xD;        })&#xD;        .then(response =&gt; response.json())&#xD;        .then(data =&gt; proc.homeContext.variables.setVar("response", JSON.stringify(data)))&#xD;}</l></block><list><block var="method"/><block var="url"/><block var="payload"/><block var="headers"/></list></block><block s="doWait"><l>0.5</l></block><block s="doReport"><block var="response"/></block></script></block-definition><block-definition s="can use unsecure websocket" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>try {&#xD;    websock = new WebSocket(&apos;ws://example.com&apos;);&#xD;} catch (e) {&#xD;    return false;&#xD;}&#xD;return true;</l></block><list></list></block></block></script></block-definition><block-definition s="can use webserial" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return navigator.serial !== undefined;</l></block><list></list></block></block></script></block-definition><block-definition s="Compass Read" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>eb</l></list><l>world.moveon = 0;&#xD;eb.compass(function(state, msg){&#xD;  if (state === &apos;complete&apos;) {&#xD;    world.moveon = 1;&#xD;  }&#xD;});</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.moveon;</l></block><list></list></block></block><block s="doReport"><block s="reportNewList"><list><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return eb.compassSensor.x;</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return eb.compassSensor.y;</l></block><list><custom-block s="connection object"></custom-block></list></block><block s="evaluate"><block s="reportJSFunction"><list><l>eb</l></list><l>return eb.compassSensor.z;</l></block><list><custom-block s="connection object"></custom-block></list></block></list></block></block></script></block-definition><block-definition s="addJS URL %&apos;url&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>url</l></list><l>var po = document.createElement(&apos;script&apos;);&#xD;  po.type = &apos;text/javascript&apos;;&#xD;  po.async = true;&#xD;  po.src = url;&#xD;  var s = document.getElementsByTagName(&apos;script&apos;)[0];&#xD;  s.parentNode.insertBefore(po, s)</l></block><list><block var="url"/></list></block></script></block-definition><block-definition s="Run Teachable Machine Model %&apos;URL&apos;" type="command" category="Advanced eBrain"><header></header><code></code><translations></translations><inputs><input type="%s"></input></inputs><script><custom-block s="addJS %s"><block s="reportJoinWords"><list><l>const URL = "</l><block var="URL"/><l>";</l></list></block></custom-block><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>alert("Please Wait -- Adding Teachable Machine Model to SNAP -- When you see the request for your webcam or microphone, then the model has loaded successfully");</l></block><list></list></block><custom-block s="addJS URL %s"><l>https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js</l></custom-block><custom-block s="addJS URL %s"><l>https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js</l></custom-block><custom-block s="addJS %s"><l>let model,webcam,labelContainer,maxPredictions;const predictionList=[];async function init(){const a=URL+"model.json",t=URL+"metadata.json";model=await tmImage.load(a,t),maxPredictions=model.getTotalClasses();webcam=new tmImage.Webcam(200,200,!0),await webcam.setup(),await webcam.play(),window.requestAnimationFrame(loop)}async function loop(){webcam.update(),await predict(),window.requestAnimationFrame(loop)}async function predict(){const a=await model.predict(webcam.canvas);for(let t=0;t&lt;maxPredictions;t++){const e=a[t].probability.toFixed(2);predictionList[t]=e}}</l></custom-block><custom-block s="addJS %s"><l>let teachableMachineAdded = 1;</l></custom-block><block s="doWait"><l>4</l></block><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>init();</l></block><list></list></block></script></block-definition><block-definition s="Class %&apos;i&apos; Confidence Level" type="reporter" category="Advanced eBrain"><header></header><code></code><translations></translations><inputs><input type="%n">1</input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><block s="reportJoinWords"><list><l>return predictionList[</l><block s="reportDifference"><block var="i"/><l>1</l></block><l>]</l></list></block></block><list></list></block></block></script></block-definition><block-definition s="Load model: %&apos;URL&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s"></input></inputs><script><block s="doIf"><block s="reportNot"><block var="ModelLoaded"/></block><script><custom-block s="Run Teachable Machine Model %s"><block var="URL"/><comment w="130.83333333333334" collapsed="false">You can only run this block in Google Chrome. Please only run it once when you load the model into the page</comment></custom-block><block s="doSetVar"><l>ModelLoaded</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script><list></list></block></script></block-definition></blocks><primitives></primitives><stage name="Stage" width="480" height="360" costume="0" color="255,255,255,1" tempo="60" threadsafe="false" penlog="false" volume="100" pan="0" lines="round" ternary="false" hyperops="true" codify="false" inheritance="true" sublistIDs="false" id="1695"><pentrails>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAFoCAYAAACPNyggAAAAAXNSR0IArs4c6QAADoVJREFUeF7t1cEJAAAIxDDdf2m3sJ+4wEEQuuMIECBAgACBd4F9XzRIgAABAgQIjAB7AgIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECByxcQFpoRMBzwAAAABJRU5ErkJggg==</pentrails><costumes><list struct="atomic" id="1696"></list></costumes><sounds><list struct="atomic" id="1697"></list></sounds><variables></variables><blocks></blocks><scripts></scripts><sprites select="1"><sprite name="Sprite" idx="1" x="0" y="0" heading="90" scale="1" volume="100" pan="0" rotation="1" draggable="true" costume="0" color="80,80,80,1" pen="tip" id="1702"><wear><costume name="Class1" center-x="140" center-y="35" image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAABHCAYAAAD2kam1AAAAAXNSR0IArs4c6QAAA05JREFUeF7t1DFu20AARNFZUhupiFI5BYkUKX2iHDLHSeUylVjEVZxC8opkQMGNDR1gBvgECHAFChi+AabozvXwpOP+rKGsGtVrLIuGpb+dB0nj2709H+/9n98QQCBC4EXSJOm03WvR1M2a1k6T5tv5dDloen7U9t67q3z7pTXiEwmJAAI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRwBhiOnK5IiYCPAcNhUQRAEcgQYjpyuSIqAjQDDYVMFQRDIEWA4croiKQI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRwBhiOnK5IiYCPAcNhUQRAEcgQYjpyuSIqAjQDDYVMFQRDIEWA4croiKQI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRwBhiOnK5IiYCPAcNhUQRAEcgQYjpyuSIqAjQDDYVMFQRDIEWA4croiKQI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRwBhiOnK5IiYCPAcNhUQRAEcgQYjpyuSIqAjQDDYVMFQRDIEWA4croiKQI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRwBhiOnK5IiYCPAcNhUQRAEcgQYjpyuSIqAjQDDYVMFQRDIEWA4croiKQI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRwBhiOnK5IiYCPAcNhUQRAEcgQYjpyuSIqAjQDDYVMFQRDIEWA4croiKQI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRwBhiOnK5IiYCPAcNhUQRAEcgQYjpyuSIqAjQDDYVMFQRDIEWA4croiKQI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRwBhiOnK5IiYCPAcNhUQRAEcgQYjpyuSIqAjQDDYVMFQRDIEWA4croiKQI2AgyHTRUEQSBHgOHI6YqkCNgIMBw2VRAEgRyBci/qw5OO+7OGsmpUr7EsGpb+dh4kjW/39nzM+VSSIoDAB4EXSZOk03avRVM3a1o7TZpv59PloOn5Udt77667w/FT6r9+V/37T3V/UN29qvZVtbuqtp1qN6uWXnVd1FMFAghkCpRO8zqrLb1avaotO7W5qV0/qV3Oal8+q/35rfZDmj9+4X8xLdM8n0iE0AAAAABJRU5ErkJggg==" id="1703"/></wear><costumes><list id="1704"><item><costume name="Class2" center-x="12.5" center-y="35.5" image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAABHCAYAAADybezkAAAAAXNSR0IArs4c6QAAAHRJREFUWEft0sEJgEAQBME1DE3D/DUBc9IYSvBl37thuWKWc5trPn7Luc398Y3pCAnHFRcJUNy64iIBiltXXCRAceuKiwQobl1xkQDFrSsuEqC4dcVFAhS3rrhIgOLWFRcJUNy64iIBilvXX7mOdXb6+4v4AYAmgi9n5SFFAAAAAElFTkSuQmCC" id="1705"/></item><item><costume name="Class1" center-x="14" center-y="35" image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAABHCAYAAAD2mDzZAAAAAXNSR0IArs4c6QAAAJpJREFUWEft2bEJgDAUhOHLGIIz2LiBg7uBjTMIjqEkIIiFhMeZxt8mlXnky/ESSJKkftWRxy+/bVBKLQpdi6CYZTthhPFVgIAQEAJiyQCMMMYFaMRxu9ufMMJII7ZkAEYY4wI04rgd55nFDkYYawVoV7VSXAssUjDCGBegXcXtuBZY7P7BmFfZ4t2zPLDmYnOn0b0/z/mmXcsJLIaMPLAAbZ0AAAAASUVORK5CYII=" id="1706"/></item></list></costumes><sounds><list struct="atomic" id="1707"></list></sounds><blocks></blocks><variables></variables><scripts><script x="116.66666666666667" y="86.66666666666698"><block s="reportVideo"><l><option>motion</option></l><l><option>myself</option></l><comment w="90" collapsed="false">press this to see yourself</comment></block></script><script x="444.1666666666667" y="75.83333333333323"><block s="doSetVar"><l>ModelLoaded</l><block s="reportBoolean"><l><bool>false</bool></l></block></block><custom-block s="Load model: %s"><l>https://teachablemachine.withgoogle.com/models/PXRPfKERO/</l><comment w="90" collapsed="false">Paste the teachableMachine link here.</comment></custom-block></script><script x="135" y="228.66666666666666"><block s="receiveGo"></block><block s="gotoXY"><l>0</l><l>0</l></block><block s="setHeading"><l>90</l></block><block s="setScale"><l>100</l></block><block s="doForever"><script><block s="doSetVar"><l>Class 1</l><custom-block s="Class %n Confidence Level"><l>1</l></custom-block></block><block s="doSetVar"><l>Class 2</l><custom-block s="Class %n Confidence Level"><l>2</l></custom-block></block><block s="doIfElse"><block s="reportVariadicGreaterThan"><list><block var="Class 1"/><block var="Class 2"/></list></block><script><block s="doSwitchToCostume"><block s="reportNewCostumeStretched"><l>Class1</l><block s="reportVariadicProduct"><list><block var="Class 1"/><l>1000</l></list></block><l>100</l></block></block></script><script><block s="doSwitchToCostume"><block s="reportNewCostumeStretched"><l>Class2</l><block s="reportVariadicProduct"><list><block var="Class 1"/><l>1000</l></list></block><l>100</l></block></block></script></block></script></block></script></scripts></sprite><watcher var="Class 1" style="normal" x="10" y="10" color="243,118,29"/><watcher var="Class 2" style="normal" x="10" y="34.400002" color="243,118,29"/><watcher var="ModelLoaded" style="normal" x="10" y="58.800004" color="243,118,29"/></sprites></stage><variables><variable name="Class 1"><l>1.00</l></variable><variable name="Class 2"><l>0.00</l></variable><variable name="ModelLoaded"><bool>true</bool></variable></variables></scene></scenes></project>